# üöÄ Ansible Playbook –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ 3x-ui –∏ XRAY

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç Bash (`run.sh`) –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –ø–∞–Ω–µ–ª–µ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 3x-ui –∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞ XRAY –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (VPS) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Ansible. –°–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏, –∫–ª—é—á–∞–º–∏ SSH –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–ø—É—Å–∫–∞, —Ä–µ—à–∞—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

* **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** –ó–∞–ø—É—Å–∫–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É, —Ç—Ä–µ–±—É—è —Ç–æ–ª—å–∫–æ IP –∏ –ø–∞—Ä–æ–ª—å.
* **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å SSH:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏ —Ö–æ—Å—Ç–∞ (`ssh-keygen -R`) –∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª—é—á–µ–π (`host_key_checking = False`) –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ `sshpass`.
* **–ß–∏—Å—Ç–æ—Ç–∞ –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã:** –£–¥–∞–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å `hosts.ini`, –ø–ª–µ–π–±—É–∫ `install.yml` –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `ansible.cfg`) –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.
* **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ 3x-ui –∏–∑–≤–ª–µ–∫–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å, –ø–æ—Ä—Ç) –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏—Ö –≤ –∫–æ–Ω—Ü–µ.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –õ–æ–∫–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç (–í–∞—à –∫–æ–º–ø—å—é—Ç–µ—Ä)

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (Debian/Ubuntu/MacOS)                                        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :--- |:-----------------------------------------------------------------------------| :--- |
| **`Ansible`** | `pip3 install ansible`/`sudo apt install ansible -y`                                                       | –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π. |
| **`sshpass`** | `sudo apt install sshpass`<br/>(macOS `brew install sshpass`)                                    | **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!** –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–∞—Ä–æ–ª—è SSH –≤ –Ω–µ–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ. |
| **`jq`** | `sudo apt install jq`<br/>(macOS `brew install jq`)                                                        | **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è!** –î–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON. |
| **`community.general`** | `sudo ansible-galaxy collection install community.general`                   | –ö–æ–ª–ª–µ–∫—Ü–∏—è Ansible, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –¥–ª—è –æ–±—â–µ—Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–¥–∞—á. |

### 2. –£–¥–∞–ª–µ–Ω–Ω—ã–π VPS

* **–û–°:** Ubuntu/Debian (—Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `apt`).
* **–î–æ—Å—Ç—É–ø:** –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω SSH-–≤—Ö–æ–¥ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `root` (–∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∞–≤–∞–º–∏ `sudo`) –ø–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É –ø–∞—Ä–æ–ª—é.
* **–ë–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã:** –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã `curl` –∏ `wget`.

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª `run.sh` –∏ –µ–º—É –¥–∞–Ω—ã –ø—Ä–∞–≤–∞ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ.

```bash
chmod +x run.sh
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª `run.sh` –∏ –µ–º—É –¥–∞–Ω—ã –ø—Ä–∞–≤–∞ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ.

```bash
sudo bash run.sh
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª `run.sh` –∏ –µ–º—É –¥–∞–Ω—ã –ø—Ä–∞–≤–∞ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ.

```bash
========================================================
‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ 3x-ui –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
========================================================
üîë –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: [–õ–æ–≥–∏–Ω]
üîí –ü–∞—Ä–æ–ª—å: [–ü–∞—Ä–æ–ª—å]
üö™ –ü–æ—Ä—Ç –ø–∞–Ω–µ–ª–∏: 2053
üåê WebBasePath: /
üîó –°—Å—ã–ª–∫–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞: http://[IP_–∞–¥—Ä–µ—Å]:2053
```
